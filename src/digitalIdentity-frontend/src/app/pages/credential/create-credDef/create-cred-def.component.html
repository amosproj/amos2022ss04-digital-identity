<mat-card class="login-card">
  <mat-card-header>
    <mat-card-title class="credDef-card-title">
      Create new Credential Definition.
    </mat-card-title>
  </mat-card-header>

  <mat-divider [inset]="true"></mat-divider>

  <mat-card-content class="login-card-content">
    <form class="credDef-form" [formGroup]="credDefFormGroup">
      <mat-form-field>
        <mat-label>Name</mat-label>
        <input
          matInput
          type="text"
          placeholder="Please enter a Credential Definition name"
          formControlName="name"
          ngDefaultControl
          name="name"
        />
      </mat-form-field>

      <mat-form-field>
        <mat-label>Comment</mat-label>
        <input
          matInput
          type="text"
          placeholder="Please enter a comment (optional)"
          ngDefaultControl
          formControlName="comment"
          name="comment"
        />
      </mat-form-field>

      <mat-checkbox
        class="tickbox"
        color="primary"
        ngDefaultControl
        name="revocable"
        [checked]="credDefFormGroup.value['revocable']"
        (change)="
          credDefFormGroup.controls['revocable'].setValue(
            !credDefFormGroup.value['revocable']
          )
        "
      >
        Revocable
      </mat-checkbox>

      {{ credDefFormGroup.value["revocable"] }}

      <div>
        <div
          [innerHtml]="error"
          *ngIf="error"
          style="color: red; text-align: center"
        ></div>

        <p>
          <input
            id="fileInput"
            type="file"
            hidden
            (change)="selectFile($event)"
            #inputFile
            disabled
          />
          <button
            (click)="inputFile.click()"
            mat-raised-button
            disabled
            color="primary"
          >
            Select image
          </button>
          <span [innerHtml]="fileName" *ngIf="fileName"></span>
          <br/>
          <mat-icon [ngStyle]="{ color: 'orange', opacity: '1' }"
            >warning</mat-icon
          >
          Adding an image/icon to a credential definition is not supported yet. It may
          be finished in the future.
        </p>
      </div>

      <p>
        <mat-form-field>
          <mat-select
            ngDefaultControl
            name="schemaId"
            [formControl]="schemaCtrl"
            placeholder="Schema selection"
            (selectionChange)="onSelected($event)"
            #singleSelect
          >
            <mat-option>
              <ngx-mat-select-search
                [formControl]="schemaFilterCtrl"
              ></ngx-mat-select-search>
            </mat-option>

            <mat-option
              *ngFor="let schema of filteredSchemas | async"
              [value]="schema.id"
            >
              {{ schema.alias }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </p>

      <div class="button-table">
        <button
          [disabled]="
            !credDefFormGroup.valid || clicked || selectedSchema == ''
          "
          (click)="createCredDef()"
          mat-raised-button
          color="accent"
        >
          Create
        </button>
      </div>
    </form>
  </mat-card-content>
</mat-card>
